<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Gas Detector</title>
    <script
    src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.2/mqttws31.min.js"
    type="text/javascript"
  ></script>
    <style>
      html {
        font-family: Helvetica;
        text-align: center;
      }
      #gasStatus {
        font-size: 2rem;
        font-weight: bold;
        color: green;
      }
      .critical {
        color: red;
        animation: blink 1s infinite;
      }
      @keyframes blink {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <h1>Gas Detector</h1>
    <p>Gas Level: <span id="gasLevel">Loading...</span> ppm</p>
    <p>Status: <span id="gasStatus">Loading...</span></p>
    <script>
      function updateStatus() {
        fetch('/update')
          .then((response) => response.json())
          .then((data) => {
            document.getElementById('gasLevel').innerText = data.gasLevel;
            const statusElem = document.getElementById('gasStatus');
            statusElem.innerText = data.gasStatus;
            if (data.gasStatus === 'BAHAYA') {
              statusElem.classList.add('critical');
            } else {
              statusElem.classList.remove('critical');
            }
          });
      }

      setInterval(updateStatus, 1000);
    </script>
  </body>
</html>
